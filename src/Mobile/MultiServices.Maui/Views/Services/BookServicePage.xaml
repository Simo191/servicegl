<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:MultiServices.Maui.ViewModels.Services"
             x:Class="MultiServices.Maui.Views.Services.BookServicePage"
             x:DataType="vm:BookServiceViewModel"
             Title="RÃ©server un service">
    <ScrollView>
        <VerticalStackLayout Padding="16" Spacing="16">
            <!-- Step Indicator -->
            <HorizontalStackLayout HorizontalOptions="Center" Spacing="8">
                <Frame BackgroundColor="{StaticResource Primary}" CornerRadius="14" HeightRequest="28" WidthRequest="28" HasShadow="False" Padding="0">
                    <Label Text="1" TextColor="White" FontSize="12" FontAttributes="Bold" HorizontalOptions="Center" VerticalOptions="Center" />
                </Frame>
                <BoxView WidthRequest="30" HeightRequest="2" BackgroundColor="{StaticResource Border}" VerticalOptions="Center" />
                <Frame BackgroundColor="#E5E7EB" CornerRadius="14" HeightRequest="28" WidthRequest="28" HasShadow="False" Padding="0">
                    <Label Text="2" TextColor="{StaticResource TextMuted}" FontSize="12" HorizontalOptions="Center" VerticalOptions="Center" />
                </Frame>
                <BoxView WidthRequest="30" HeightRequest="2" BackgroundColor="{StaticResource Border}" VerticalOptions="Center" />
                <Frame BackgroundColor="#E5E7EB" CornerRadius="14" HeightRequest="28" WidthRequest="28" HasShadow="False" Padding="0">
                    <Label Text="3" TextColor="{StaticResource TextMuted}" FontSize="12" HorizontalOptions="Center" VerticalOptions="Center" />
                </Frame>
            </HorizontalStackLayout>

            <Frame Style="{StaticResource CardFrame}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="ðŸ“ DÃ©crivez votre problÃ¨me" Style="{StaticResource Title3}" />
                    <Editor Placeholder="DÃ©crivez le problÃ¨me en dÃ©tail..." Text="{Binding ProblemDescription}"
                            HeightRequest="120" BackgroundColor="#F9FAFB" />
                    <HorizontalStackLayout Spacing="8">
                        <Button Text="ðŸ“· Photo" Style="{StaticResource SecondaryButton}" Command="{Binding AddPhotoCommand}" HeightRequest="40" />
                        <Button Text="ðŸ–¼ï¸ Galerie" Style="{StaticResource SecondaryButton}" Command="{Binding PickPhotoCommand}" HeightRequest="40" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <Frame Style="{StaticResource CardFrame}">
                <VerticalStackLayout Spacing="12">
                    <Label Text="ðŸ“… Date et heure" Style="{StaticResource Title3}" />
                    <!-- FIX: Bind MinimumDate to ViewModel property instead of sys:DateTime.Today -->
                    <DatePicker Date="{Binding SelectedDate}" MinimumDate="{Binding MinimumDate}" />
                    <Button Text="Voir les crÃ©neaux" Style="{StaticResource SecondaryButton}" Command="{Binding LoadSlotsCommand}" HeightRequest="40" />
                </VerticalStackLayout>
            </Frame>

            <Button Text="Confirmer la rÃ©servation" Style="{StaticResource PrimaryButton}" Command="{Binding ConfirmBookingCommand}" Margin="0,8" />
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
